) +
geom_world() +
coord_sf(
xlim   = cn_xlim,
ylim   = cn_ylim,
expand = FALSE
) +
labs(
x = "Longitude",
y = "Latitude"
) +
theme_bw()
crs_robin <- "+proj=robin +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin) +
annotation_graticule(
crs          = crs_robin,
lon_step     = 30,
lat_step     = 15,
label_offset = 3e5
) +
coord_sf(
crs    = crs_robin,
expand = FALSE
) +
theme_void()
crs_robin <- "+proj=robin +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin) +
annotation_graticule(
crs          = crs_robin,
lon_step     = 30,
lat_step     = 15,
label_offset = 3e5
) +
coord_sf(crs = crs_robin) +
theme_void()
library(pkgdown)
# 一键重建整个网站
pkgdown::build_site()
pkgdown::preview_site(path='news/index.html')
pkgdown::clean_site()
pkgdown::build_site()
pkgdown::preview_site(path='articles/index.html')
pkgdown::build_site()
?check_geodata()
check_geodata(c(
"world_countries.rda",
"world_coastlines.rda",
"world_boundaries.rda"
))
# Single file: reuse existing file if present (default overwrite = FALSE)
check_geodata(files = "boundary.rda")
# Single file: reuse existing file if present (default overwrite = FALSE)
check_geodata(files = "boundary.rda")
check_geodata(c(
"world_countries.rda",
"world_coastlines.rda",
"world_boundaries.rda"
))
check_geodata()
pkgdown::clean_site()
# 一键重建整个网站
pkgdown::build_site()
?geom_mapcn
ggplot2::ggplot() +
geom_mapcn() +
ggplot2::theme_minimal()
ggplot2::ggplot() +
geom_mapcn(
admin_level = "city",
fill = "grey95",
color = "grey60"
) +
geom_boundary_cn(province_color = "grey40") +
ggplot2::theme_bw()
# 1. Basic provincial map (recommended: combine with geom_boundary_cn)
ggplot2::ggplot() +
geom_mapcn() +
geom_boundary_cn() +
ggplot2::theme_minimal()
?basemap_dem
# Check and download the required data files if they are missing
check_geodata(files = c("gebco_2024_China.tif", "China_mask.gpkg"))
# Define the CRS for China (EPSG:4326 is a common global geographic coordinate system)
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
# Example 1: Display full rectangular area around China using built-in DEM data
ggplot() +
basemap_dem(within_china = FALSE) +
tidyterra::scale_fill_hypso_tint_c(
palette = "gmt_globe",
breaks = c(-10000, -5000, 0, 2000, 5000, 8000)
) +
theme_minimal()
# Example 2: Display only China's DEM and boundaries using built-in DEM data
ggplot() +
basemap_dem(crs = china_proj, within_china = TRUE) +
geom_boundary_cn(crs = china_proj) +
tidyterra::scale_fill_hypso_c(
palette = "dem_print",
breaks = c(0, 2000, 4000, 6000),
limits = c(0, 7000)
) +
labs(fill = "Elevation (m)") +
theme_minimal()
ggplot() +
geom_mapcn() +
geom_boundary_cn() +
theme_minimal()
?geom_mapcn
# 2. City-level map with custom fill and boundaries
ggplot() +
geom_mapcn(
admin_level = "city",
fill = "grey95",
color = "grey60"
) +
geom_boundary_cn(province_color = "grey40") +
theme_bw()
# 3. Filter by attribute (e.g., English names) and highlight selected provinces
ggplot() +
geom_mapcn(
filter_attribute = "name_en",
filter = c("Beijing", "Shanghai"),
fill = "tomato"
) +
geom_boundary_cn() +
theme_minimal()
# 4. Use a different projection (e.g., Albers equal-area)
albers_cn <- "+proj=aea +lat_1=25 +lat_2=47 +lat_0=0 +lon_0=105 +datum=WGS84"
ggplot() +
geom_mapcn(crs = albers_cn, linewidth = 0.3) +
geom_boundary_cn(crs = albers_cn) +
coord_sf(crs = albers_cn) +
theme_minimal()
?geom_boundary_cn
# Example 1: Basic China map
ggplot() +
geom_boundary_cn() +
theme_minimal()
# Example 2: Add compass and scale bar (easy mode)
ggplot() +
geom_boundary_cn(compass = TRUE, scale = TRUE) +
theme_minimal()
# Example 3: Custom styling
ggplot() +
geom_boundary_cn(
coastline_color  = "steelblue",
province_color   = "grey70",
province_linetype = "dashed"
) +
theme_minimal()
# Example 4: Advanced usage with a custom projected CRS (Albers)
albers_cn <- "+proj=aea +lat_1=25 +lat_2=47 +lat_0=0 +lon_0=105 +datum=WGS84 +units=m +no_defs"
ggplot() +
geom_boundary_cn(crs = albers_cn) +
annotation_compass(location = "tl", which_north = "true") +
annotation_scalebar(location = "bl", fixed_width = 500000, display_unit = "km") +
coord_sf(crs = albers_cn) +
theme_minimal()
?annotation_compass
nc <- sf::st_read(system.file("shape/nc.shp", package="sf"), quiet = TRUE)
base <- ggplot2::ggplot() +
ggplot2::geom_sf(data = nc, fill = "grey90") +
ggplot2::theme_minimal()
# Example 1: Grid north (no CRS required), bottom-left
base + annotation_compass()
# Example 2: Custom style & position (top-left)
base + annotation_compass(location = "tl", style = compass_sinan())
# Example 3: True north (requires a CRS)
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass(which_north = "true")
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass((location = "bl",which_north = "true")
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass((location = "bl", which_north = "true")
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass(location = "bl", which_north = "true")
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass(location = "br", which_north = "true")
# Example 3: True north (requires a CRS)
base +
ggplot2::coord_sf(crs = "+proj=lcc +lon_0=-100 +lat_1=33 +lat_2=45") +
annotation_compass(location = "tr", which_north = "true")
?annotation_scalebar
nc <- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
base_plot <- ggplot2::ggplot() +
ggplot2::geom_sf(data = nc, fill = "grey90") +
ggplot2::theme_minimal()
# Example 1: Projected CRS with a longer scale bar
base_plot + ggplot2::coord_sf(crs = 32617) +
annotation_scalebar(location = "bl", width_hint = 0.5)
nc <- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
base_plot <- ggplot() +
geom_sf(data = nc, fill = "grey90") +
theme_minimal()
# Example 1: Projected CRS with a longer scale bar
base_plot +
coord_sf(crs = 32617) +
annotation_scalebar(location = "bl", width_hint = 0.5)
nc <- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
base_plot <- ggplot() +
geom_sf(data = nc, fill = "grey90") +
theme_minimal()
# Example 1: Projected CRS with a longer scale bar
base_plot +
coord_sf(crs = 32617) +
annotation_scalebar(location = "bl", width_hint = 0.5)
# Example 2: Ticks style, top-right
base_plot +
coord_sf(crs = 32617) +
annotation_scalebar(location = "tr", style = "ticks")
# Example 3: Geographic CRS (EPSG:4326), approximate meters (warns)
base_plot +
coord_sf(crs = 4326) +
annotation_scalebar(location = "bl", geographic_mode = "approx_m")
# Example 4: Force a 100 km bar with red outlines
base_plot +
coord_sf(crs = 32617) +
annotation_scalebar(
location     = "bl",
fixed_width  = 100000,
display_unit = "km",
line_col     = "red"
)
?basemap_dem
# Example 1: Display full rectangular area around China using built-in DEM data
ggplot() +
basemap_dem(within_china = FALSE) +
tidyterra::scale_fill_hypso_tint_c(
palette = "gmt_globe",
breaks = c(-10000, -5000, 0, 2000, 5000, 8000)
) +
theme_minimal()
?coord_proj
ggplot() +
geom_world() +
coord_proj(
crs = "+proj=robin",
xlim = c(-180, 180),
ylim = c(-60, 85),
expand = FALSE
)
ggplot() +
geom_world(show_ocean = FALSE) +
coord_proj(
crs = "+proj=robin",
xlim = c(-180, 180),
ylim = c(-60, 85),
expand = FALSE
)
?geom_world
ggplot() +
geom_world() +
coord_proj(
crs = "+proj=aeqd +lat_0=35 +lon_0=105",
xlim = c(70, 140),   # 经度
ylim = c(0, 60)      # 纬度
)
ggplot() +
geom_world(crs = "+proj=robin +lon_0=150") +
coord_proj(
crs = "+proj=robin +lon_0=150",
xlim = c(50, 180),
ylim = c(-20, 80)
)
ggplot() +
geom_world() +
coord_proj(
crs = "+proj=robin +lon_0=150",
xlim = c(50, 180),
ylim = c(-20, 80)
)
ggplot() +
geom_world() +
coord_proj(
crs = 4326,
xlim = c(50, 180),
ylim = c(-20, 80)
)
?coord_proj
# Example 1: World map with WGS84 limits
ggplot() +
geom_world() +
coord_proj(
crs = "+proj=longlat +datum=WGS84",
xlim = c(-180, 180),
ylim = c(-90, 90),
expand = FALSE
) +
theme_minimal()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world(fill = "lightblue") +
coord_proj(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_minimal()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world() +
coord_proj(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_minimal()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world(fill = "lightblue") +
coord_proj(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_void()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world() +
coord_proj(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_void()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world() +
coord_sf(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_void()
# Example 2: China (AEQD projection) with geographic limits
china_proj <- "+proj=aeqd +lat_0=35 +lon_0=105 +ellps=WGS84 +units=m +no_defs"
ggplot() +
geom_world(crs = china_proj) +
coord_proj(
crs = china_proj,
xlim = c(60, 140),
ylim = c(-10, 50)
) +
theme_void()
ggplot() +
geom_mapcn(fill = "white") +
geom_boundary_cn() +
theme_bw() +
coord_proj(
crs = china_proj,
expand = FALSE,
xlim = c(105, 126),   # lon range
ylim = c(2, 23)       # lat range
)
?geom_loc
# Generate a random dataset with latitude and longitude
set.seed(123)
data_sim <- data.frame(
Longitude = runif(100, 80, 120),
Latitude = runif(100, 28, 40),
Category = sample(c("Type A", "Type B", "Type C"), 100, replace = TRUE)
)
# Visualize the data with China's boundaries
ggplot() +
geom_boundary_cn() +
geom_loc(
data = data_sim, lon = "Longitude", lat = "Latitude",
mapping = aes(color = Category), size = 1, alpha = 0.7
) +
theme_minimal()
ggplot() +
geom_mapcn(color = "white", fill = "lightgrey") +
geom_boundary_cn() +
theme_bw()
Albers = "+proj=aea +lat_1=25 +lat_2=47 +lat_0=0 +lon_0=110 +datum=WGS84 +units=m +no_defs"
> ggplot() +
Albers = "+proj=aea +lat_1=25 +lat_2=47 +lat_0=0 +lon_0=110 +datum=WGS84 +units=m +no_defs"
ggplot() +
geom_buffer_cn(mainland_dist = 40000, fill = "#D2D5EC") +
geom_buffer_cn(mainland_dist = 20000, fill = "#BBB3D8") +
geom_mapcn(color = "transparent", fill = "white") +
geom_boundary_cn(province_color = "grey") +
coord_proj(crs = Albers) +
theme_bw()
library(pkgdown)
# 一键重建整个网站
pkgdown::build_site()
options(pkgdown.internet = FALSE)
pkgdown::build_site()
# 1. Simplest world map
ggplot() +
geom_world() +
theme_void()
# 1. Simplest world map
ggplot() +
geom_world() +
theme_void()
library(ggmapcn)
packageVersion("ggmapcn")
# 看看 geom_world 是从哪里来的
getAnywhere(geom_world)$where
# 看看函数开头几行是不是你贴的这个版本
getAnywhere(geom_world)$text[1:40]
library(ggmapcn)
packageVersion("ggmapcn")
# 看看 geom_world 是从哪里来的
getAnywhere(geom_world)$where
# 看看函数开头几行是不是你贴的这个版本
getAnywhere(geom_world)$text[1:40]
library
library(ggmapcn)
?geom_world
# 1. Simplest world map
ggplot() +
geom_world() +
theme_void()
library(ggmapcn)
library(ggplot2)
library(sf)
## 1. 看看 geom_world 返回了几层 -----------------------------
layers <- ggmapcn:::geom_world()
length(layers)      # 正常应该 >= 3
layers[[1]]         # ≈ ocean 图层
layers[[1]]$geom    # 看看是不是 geom_sf
## 2. 看第 1 层用的 data（就是 ocean 轮廓） -------------------
ocean <- layers[[1]]$data
class(ocean)
sf::st_crs(ocean)
sf::st_geometry_type(ocean)
library(ggplot2)
library(ggmapcn)
ggplot() +
geom_world() +
theme_void()
# 2. World map with long–lat axes
ggplot() +
geom_world() +
coord_sf(
crs    = 4326,
expand = FALSE,
datum  = sf::st_crs(4326)
) +
theme_minimal()
# 3. Without ocean layer
ggplot() +
geom_world(show_ocean = FALSE) +
theme_minimal()
# 5. Robinson projection centred at 150°E
crs_robin_150 <- "+proj=robin +lon_0=150 +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin_150) +
coord_sf(crs = crs_robin_150) +
theme_void()
# 5. Robinson projection centred at 150°E
crs_robin_150 <- "+proj=robin +lon_0=150 +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin_150) +
coord_sf(crs = crs_robin_150) +
theme_void()
ggplot() +
geom_world() +
theme_void()
# 1. Simplest world map
ggplot() +
geom_world() +
theme_void()
# 2. World map with long–lat axes
ggplot() +
geom_world() +
coord_sf(
crs    = 4326,
expand = FALSE,
datum  = sf::st_crs(4326)
) +
theme_minimal()
# 3. Without ocean layer
ggplot() +
geom_world(show_ocean = FALSE) +
theme_minimal()
# 4. Without administrative boundaries
ggplot() +
geom_world(show_admin_boundaries = FALSE) +
theme_minimal()
# 5. Robinson projection centred at 150°E
crs_robin_150 <- "+proj=robin +lon_0=150 +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin_150) +
coord_sf(crs = crs_robin_150) +
theme_void()
# 5. Robinson projection centred at 150°E
crs_robin_150 <- "+proj=robin +lon_0=150 +datum=WGS84"
ggplot() +
geom_world(crs = crs_robin_150) +
coord_sf(crs = crs_robin_150) +
theme_void()
