# ggmapcn

`ggmapcn` is a `ggplot2` extension package for visualizing maps of China
and the world with customizable projections and cartographic styling.

Because CRAN imposes strict size limits on package data, certain large
geospatial datasets used by `ggmapcn` cannot be bundled directly. These
datasets are stored externally and retrieved automatically using
[`check_geodata()`](https://rimagination.github.io/ggmapcn/reference/check_geodata.md).
All high-level functions—such as
[`geom_mapcn()`](https://rimagination.github.io/ggmapcn/reference/geom_mapcn.md)
and
[`geom_world()`](https://rimagination.github.io/ggmapcn/reference/geom_world.md)—internally
call
[`check_geodata()`](https://rimagination.github.io/ggmapcn/reference/check_geodata.md)
to ensure that required data files exist locally.

If the network is unavailable or remote mirrors cannot be reached,
[`check_geodata()`](https://rimagination.github.io/ggmapcn/reference/check_geodata.md)
fails gracefully by returning `NA` paths. This behavior is fully
compliant with CRAN’s policy for optional network resources.

------------------------------------------------------------------------

## Installation

Install the development version from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("Rimagination/ggmapcn", force = TRUE)
```

------------------------------------------------------------------------

# Data Management with `check_geodata()`

Several datasets—such as `world_countries.rda`, `China_sheng.rda`, and
`gebco_2024_China.tif`—are hosted externally.  
[`check_geodata()`](https://rimagination.github.io/ggmapcn/reference/check_geodata.md)
automatically:

- searches for existing files in:
  - user-specified `local_dirs`
  - the package `extdata` directory
  - the per-user cache directory via
    `tools::R_user_dir("ggmapcn", "data")`
- downloads missing files from mirrors (jsDelivr and GitHub)
- verifies checksums when available
- retries on failure and supports resume capability
- returns `NA` instead of errors when mirrors cannot be reached

To check and retrieve all files:

``` r
check_geodata()
```

To retrieve explicitly the datasets used by
[`geom_world()`](https://rimagination.github.io/ggmapcn/reference/geom_world.md):

``` r
check_geodata(c(
  "world_countries.rda",
  "world_coastlines.rda",
  "world_boundaries.rda"
))
```

If your network cannot access `cdn.jsdelivr.net` or
`raw.githubusercontent.com`, you may manually download the files and
place them in a directory passed to `local_dirs`.

------------------------------------------------------------------------

# Usage Examples

## 1. Basic Map of China

``` r
library(ggplot2)
library(ggmapcn)

ggplot() +
  geom_mapcn() +
  geom_boundary_cn() +
  theme_minimal()
```

![Figure](reference/figures/README-example-cn-basic-1.png)

------------------------------------------------------------------------

## 2. Custom Projection (Albers)

``` r
ggplot() +
  geom_mapcn(
    crs = "+proj=aea +lat_1=25 +lat_2=47 +lat_0=0 +lon_0=105 +datum=WGS84",
    fill = "white",
    color = "black",
    size = 0.7
  ) +
  geom_boundary_cn() +
  theme_bw()
```

![Figure](reference/figures/README-example-cn-albers-1.png)

------------------------------------------------------------------------

## 3. Adding Mainland Borders and Coastlines

``` r
ggplot() +
  geom_mapcn(fill = NA) +
  geom_boundary_cn(
    mainland_color = "black",
    mainland_size = 0.5,
    coastline_color = "skyblue",
    coastline_size = 0.5
  ) +
  theme_bw()
```

![Figure](reference/figures/README-example-cn-boundaries-1.png)

------------------------------------------------------------------------

## 4. Buffer Zones

``` r
ggplot() +
  geom_buffer_cn(mainland_dist = 40000) +
  geom_buffer_cn(mainland_dist = 20000, fill = "#BBB3D8") +
  geom_mapcn(fill = "white") +
  geom_boundary_cn() +
  theme_bw()
#> Warning: attribute variables are assumed to be spatially constant throughout
#> all geometries
#> Warning: attribute variables are assumed to be spatially constant throughout
#> all geometries
```

![Figure](reference/figures/README-example-cn-buffer-1.png)

------------------------------------------------------------------------

## 5. World Map (WGS84)

``` r
ggplot() +
  geom_world(show_ocean = FALSE) +
  theme_bw()
#> Warning: geom_world() has been redesigned; its interface and defaults have
#> changed compared to earlier development versions. See ?geom_world for details.
```

![Figure](reference/figures/README-example-world-1.png)

------------------------------------------------------------------------

# Data Sources

## China administrative boundaries

Provided by **Tianditu**  
<https://cloudcenter.tianditu.gov.cn/administrativeDivision/>

Province-, prefecture-, and county-level boundaries are preprocessed and
simplified for efficient rendering in `ggplot2`.

## Global administrative boundaries

The global dataset (countries, coastlines, and political boundaries) is
curated and maintained by the package authors. It is optimized for
consistent cartographic outputs across world projections and supports
antimeridian splitting.

------------------------------------------------------------------------

# Learn More

See the Articles for tutorials on:

- global projections and antimeridian handling  
- elevation and raster overlays  
- vegetation and environmental data  
- styling world and China maps  
- regional vs. global map workflows

------------------------------------------------------------------------

# Package index

## All functions

- [`annotation_compass()`](https://rimagination.github.io/ggmapcn/reference/annotation_compass.md)
  : Add a Spatially-Aware Compass
- [`annotation_graticule()`](https://rimagination.github.io/ggmapcn/reference/annotation_graticule.md)
  : Global graticule annotation for ggplot2 maps
- [`annotation_scalebar()`](https://rimagination.github.io/ggmapcn/reference/annotation_scalebar.md)
  : Add a Spatially-Aware Scale Bar
- [`basemap_dem()`](https://rimagination.github.io/ggmapcn/reference/basemap_dem.md)
  : Elevation Map of China Layer for ggplot2
- [`basemap_vege()`](https://rimagination.github.io/ggmapcn/reference/basemap_vege.md)
  : Vegetation Map of China Layer for ggplot2
- [`check_geodata()`](https://rimagination.github.io/ggmapcn/reference/check_geodata.md)
  : Check and retrieve required geodata files
- [`north_arrow_classic()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`compass_sinan()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`north_arrow_solid()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`compass_rose_simple()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`compass_rose_classic()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`compass_rose_circle()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  [`compass_guiding_fish()`](https://rimagination.github.io/ggmapcn/reference/compass-styles.md)
  : Classic North Arrow Style (Minimal)
- [`coord_proj()`](https://rimagination.github.io/ggmapcn/reference/coord_proj.md)
  : Coordinate System with Geographic Limits Automatically Transformed
  to a Projection
- [`geom_boundary_cn()`](https://rimagination.github.io/ggmapcn/reference/geom_boundary_cn.md)
  : Plot Boundaries of China
- [`geom_buffer_cn()`](https://rimagination.github.io/ggmapcn/reference/geom_buffer_cn.md)
  : Plot Buffered Layers for China's Boundary
- [`geom_loc()`](https://rimagination.github.io/ggmapcn/reference/geom_loc.md)
  : Visualize Spatial Point Data
- [`geom_mapcn()`](https://rimagination.github.io/ggmapcn/reference/geom_mapcn.md)
  : Plot China Map with Customizable Options
- [`geom_world()`](https://rimagination.github.io/ggmapcn/reference/geom_world.md)
  : Convenient Global Basemap Layer for ggplot2
- [`ggmapcn`](https://rimagination.github.io/ggmapcn/reference/ggmapcn-package.md)
  [`ggmapcn-package`](https://rimagination.github.io/ggmapcn/reference/ggmapcn-package.md)
  : ggmapcn: China-Focused Mapping Tools with Optional Global Support
  for ggplot2

# Articles

### All vignettes

- [Adding_Basic_Map](https://rimagination.github.io/ggmapcn/articles/Adding_Basic_Map.md):
- [Advanced scale bar and compass
  annotations](https://rimagination.github.io/ggmapcn/articles/Advanced_Scalebar_and_Compass.md):
- [World map overview with
  geom_world()](https://rimagination.github.io/ggmapcn/articles/World_Map_Overview.md):
