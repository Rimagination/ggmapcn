<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check and retrieve required geodata files — check_geodata • ggmapcn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check and retrieve required geodata files — check_geodata"><meta name="description" content="Ensures that external geospatial data files required by ggmapcn are
available locally. Existing files are reused when overwrite = FALSE;
missing files are downloaded from remote mirrors when possible. If all
mirrors fail (for example, due to network restrictions), the function fails
gracefully by returning NA for the affected files without raising
warnings or errors, in line with CRAN policy."><meta property="og:description" content="Ensures that external geospatial data files required by ggmapcn are
available locally. Existing files are reused when overwrite = FALSE;
missing files are downloaded from remote mirrors when possible. If all
mirrors fail (for example, due to network restrictions), the function fails
gracefully by returning NA for the affected files without raising
warnings or errors, in line with CRAN policy."><meta property="og:image" content="https://rimagination.github.io/ggmapcn/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggmapcn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Adding_Basic_Map.html">Adding Basic Map</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Scalebar_and_Compass.html">Advanced Scalebar and Compass</a></li>
    <li><a class="dropdown-item" href="../articles/World_Map_Overview.html">World Map Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rimagination/ggmapcn">GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check and retrieve required geodata files</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rimagination/ggmapcn/blob/HEAD/R/check_geodata.R" class="external-link"><code>R/check_geodata.R</code></a></small>
      <div class="d-none name"><code>check_geodata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Ensures that external geospatial data files required by <span class="pkg">ggmapcn</span> are
available locally. Existing files are reused when <code>overwrite = FALSE</code>;
missing files are downloaded from remote mirrors when possible. If all
mirrors fail (for example, due to network restrictions), the function fails
gracefully by returning <code>NA</code> for the affected files without raising
warnings or errors, in line with CRAN policy.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_geodata</span><span class="op">(</span></span>
<span>  files <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_retries <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  mirrors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_checksum <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checksums <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resume <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  local_dirs <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-files">files<a class="anchor" aria-label="anchor" href="#arg-files"></a></dt>
<dd><p>Character vector of file names. If <code>NULL</code>, all known files
are processed.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, forces re-download even when a
non-empty file already exists.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, suppresses progress output and
messages.</p></dd>


<dt id="arg-max-retries">max_retries<a class="anchor" aria-label="anchor" href="#arg-max-retries"></a></dt>
<dd><p>Integer; number of retry attempts per file and mirror.</p></dd>


<dt id="arg-mirrors">mirrors<a class="anchor" aria-label="anchor" href="#arg-mirrors"></a></dt>
<dd><p>Character vector of base URLs ending with <code>/</code>. If
<code>NULL</code>, package defaults are used.</p></dd>


<dt id="arg-use-checksum">use_checksum<a class="anchor" aria-label="anchor" href="#arg-use-checksum"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, verifies SHA-256 checksums when
available.</p></dd>


<dt id="arg-checksums">checksums<a class="anchor" aria-label="anchor" href="#arg-checksums"></a></dt>
<dd><p>Optional named character vector of SHA-256 digests.
If <code>NULL</code>, defaults derived from <code>known_files()</code> are used.</p></dd>


<dt id="arg-resume">resume<a class="anchor" aria-label="anchor" href="#arg-resume"></a></dt>
<dd><p>Logical; whether to attempt HTTP range resume for partially
downloaded <code>.part</code> files.</p></dd>


<dt id="arg-local-dirs">local_dirs<a class="anchor" aria-label="anchor" href="#arg-local-dirs"></a></dt>
<dd><p>Character vector of directories to search prior to any
download attempt.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A character vector of absolute file paths. Any file that cannot be obtained
is returned as <code>NA</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Because CRAN enforces strict limits on package size, several large datasets
are hosted externally rather than bundled in the package. <code>check_geodata()</code>
locates or retrieves these files using the following priority:</p><ol><li><p>user-specified <code>local_dirs</code></p></li>
<li><p>the package <code>extdata</code> directory</p></li>
<li><p>the per-user cache directory via <code>tools::R_user_dir("ggmapcn", "data")</code></p></li>
</ol><p>High-level mapping functions such as <code><a href="geom_mapcn.html">geom_mapcn()</a></code> and <code><a href="geom_world.html">geom_world()</a></code>
call <code>check_geodata()</code> internally, so most users do not need to invoke it
directly. However, running it explicitly can be useful to pre-fetch or verify
required files.</p>
<p>On networks that cannot reliably access <code>cdn.jsdelivr.net</code> or
<code>raw.githubusercontent.com</code>, downloads may time out and the corresponding
entries in the returned vector will be <code>NA</code>. In such cases, users may
manually download the required files from the data repository and place them
into a directory supplied through <code>local_dirs</code>, the package <code>extdata</code>
directory, or the user cache directory so that downloads are skipped.</p>
<p>Note: recent versions of <code><a href="geom_world.html">geom_world()</a></code> use the following world datasets:
<code>world_countries.rda</code>, <code>world_coastlines.rda</code>, and
<code>world_boundaries.rda</code>. The legacy <code>world.rda</code> file is no longer
used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># interactive() &amp;&amp; curl::has_internet()</span></span></span>
<span class="r-in"><span><span class="co"># Ensure that all default datasets are available (downloads only if needed)</span></span></span>
<span class="r-in"><span><span class="fu">check_geodata</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Datasets used by geom_world()</span></span></span>
<span class="r-in"><span><span class="fu">check_geodata</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"world_countries.rda"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"world_coastlines.rda"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"world_boundaries.rda"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># China administrative boundaries</span></span></span>
<span class="r-in"><span><span class="fu">check_geodata</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"China_sheng.rda"</span>, <span class="st">"China_shi.rda"</span>, <span class="st">"China_xian.rda"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reuse files manually placed in the working directory</span></span></span>
<span class="r-in"><span><span class="fu">check_geodata</span><span class="op">(</span><span class="st">"world_countries.rda"</span>, local_dirs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Liang Ren.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

